{%extends 'layout.html' %}
{%load crispy_forms_tags%}
{%block content%}
      {%if user.first_name%}
      <h1 class="text-center">Welcome, {{user.first_name}} {{user.last_name}}</h1>
      {%else%}
      <h1 class="text-center">Welcome, {{user.username}}</h1>
      {%endif%}
      <div class="container">
      {%if messages%}
      {%for message in messages%}
            <div class="alert alert-{{message.tags}} text-center">{{message}}</div>
      {%endfor%}
      {%endif%}
      </div>
      
      <div class="container-fluid table-responsive mt-3 mb-10">
            <form class="mb-4" method="post">
                  {%csrf_token%}
                  <div class="row mb-4">
                    <div class="col">
                      <input type="text" class="form-control" placeholder="Search" name="search">
                    </div>
                    <div class="col">
                        <select class="form-select" name="choice">
                              <option>Name</option>
                              <option>Mobile Phone Number</option>
                              <option>Doctor Name</option>
                        </select>
                    </div>
                    <div class="col">
                        <input type="submit" class="form-control btn btn-primary" placeholder="Search" value="Search">
                    </div>
                  </div>
                  <div class="row">
                        <div class="col">
                            <select class="form-select" name="dbchoice">
                                  <option>Patients</option>
                                  <option>Appointments</option>
                            </select>
                        </div>
                  </div>
            </form>
            <table class="table table-sm table-bordered caption-top">
                  {%if choice == 'Name'%}
                        {%if dbchoice == 'Appointments'%}
                        <caption>List of Appointments where the patient's name contains {{name}}</caption>
                        {%else%}
                        <caption>List of Patients where their name contains {{name}}</caption>
                        {%endif%}
                  {%elif choice == 'Doctor Name'%}
                        {%if dbchoice == 'Appointments'%}
                        <caption>List of Appointments where the Doctor's name contains {{name}}</caption>
                        {%endif%}
                  {%elif choice == 'Mobile Phone Number'%}
                        {%if dbchoice == 'Appointments'%}
                        <caption>List of Appointments where the patient's Phone Number is {{name}}</caption>
                        {%else%}
                        <caption>List of Patients where their phone number is {{name}}</caption>
                        {%endif%}
                  {%endif%}
                  <tr>
                        {%for x in columns%}
                        <th>{{x}}</th>
                        {%endfor%}
                  </tr>
            {%if lists%}
                  {%for list in lists%}
                        <tr>
                        {%for item in list%}
                              {%if item is None%}
                              <td></td>
                              {%else%}
                              <td>{{item}}</td>
                              {%endif%}
                        {%endfor%}
                        </tr>
                  {%endfor%}
            {%endif%}
      </div>
{%endblock%}